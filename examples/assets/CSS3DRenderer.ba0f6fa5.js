import{u as q,n as C,v as D,Q as P}from"./three.237d835c.js";class k extends q{constructor(l=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=l,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(i){i.element instanceof Element&&i.element.parentNode!==null&&i.element.parentNode.removeChild(i.element)})})}copy(l,i){return super.copy(l,i),this.element=l.element.cloneNode(!0),this}}const v=new C,O=new D,E=new D,W=new C,z=new C;class B{constructor(l={}){const i=this;let p,f,S,x;const c={objects:new WeakMap},a=l.element!==void 0?l.element:document.createElement("div");a.style.overflow="hidden",this.domElement=a,this.getSize=function(){return{width:p,height:f}},this.render=function(r,t){r.autoUpdate===!0&&r.updateMatrixWorld(),t.parent===null&&t.updateMatrixWorld(),O.copy(t.matrixWorldInverse),E.multiplyMatrices(t.projectionMatrix,O),u(r,r,t),w(r)},this.setSize=function(r,t){p=r,f=t,S=p/2,x=f/2,a.style.width=r+"px",a.style.height=t+"px"};function u(r,t,e){if(r.isCSS2DObject){v.setFromMatrixPosition(r.matrixWorld),v.applyMatrix4(E);const s=r.visible===!0&&v.z>=-1&&v.z<=1&&r.layers.test(e.layers)===!0;if(r.element.style.display=s===!0?"":"none",s===!0){r.onBeforeRender(i,t,e);const o=r.element;o.style.transform="translate(-50%,-50%) translate("+(v.x*S+S)+"px,"+(-v.y*x+x)+"px)",o.parentNode!==a&&a.appendChild(o),r.onAfterRender(i,t,e)}const d={distanceToCameraSquared:n(e,r)};c.objects.set(r,d)}for(let s=0,d=r.children.length;s<d;s++)u(r.children[s],t,e)}function n(r,t){return W.setFromMatrixPosition(r.matrixWorld),z.setFromMatrixPosition(t.matrixWorld),W.distanceToSquared(z)}function M(r){const t=[];return r.traverse(function(e){e.isCSS2DObject&&t.push(e)}),t}function w(r){const t=M(r).sort(function(s,d){if(s.renderOrder!==d.renderOrder)return d.renderOrder-s.renderOrder;const o=c.objects.get(s).distanceToCameraSquared,m=c.objects.get(d).distanceToCameraSquared;return o-m}),e=t.length;for(let s=0,d=t.length;s<d;s++)t[s].element.style.zIndex=e-s}}}const N=new C,I=new P,R=new C;class T extends q{constructor(l=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=l,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(i){i.element instanceof Element&&i.element.parentNode!==null&&i.element.parentNode.removeChild(i.element)})})}copy(l,i){return super.copy(l,i),this.element=l.element.cloneNode(!0),this}}class L extends T{constructor(l){super(l),this.isCSS3DSprite=!0,this.rotation2D=0}copy(l,i){return super.copy(l,i),this.rotation2D=l.rotation2D,this}}const h=new D,F=new D;class Q{constructor(l={}){const i=this;let p,f,S,x;const c={camera:{fov:0,style:""},objects:new WeakMap},a=l.element!==void 0?l.element:document.createElement("div");a.style.overflow="hidden",this.domElement=a;const u=document.createElement("div");u.style.transformStyle="preserve-3d",u.style.pointerEvents="none",a.appendChild(u),this.getSize=function(){return{width:p,height:f}},this.render=function(t,e){const s=e.projectionMatrix.elements[5]*x;c.camera.fov!==s&&(a.style.perspective=e.isPerspectiveCamera?s+"px":"",c.camera.fov=s),t.autoUpdate===!0&&t.updateMatrixWorld(),e.parent===null&&e.updateMatrixWorld();let d,o;e.isOrthographicCamera&&(d=-(e.right+e.left)/2,o=(e.top+e.bottom)/2);const y=(e.isOrthographicCamera?"scale("+s+")translate("+n(d)+"px,"+n(o)+"px)"+M(e.matrixWorldInverse):"translateZ("+s+"px)"+M(e.matrixWorldInverse))+"translate("+S+"px,"+x+"px)";c.camera.style!==y&&(u.style.transform=y,c.camera.style=y),r(t,t,e)},this.setSize=function(t,e){p=t,f=e,S=p/2,x=f/2,a.style.width=t+"px",a.style.height=e+"px",u.style.width=t+"px",u.style.height=e+"px"};function n(t){return Math.abs(t)<1e-10?0:t}function M(t){const e=t.elements;return"matrix3d("+n(e[0])+","+n(-e[1])+","+n(e[2])+","+n(e[3])+","+n(e[4])+","+n(-e[5])+","+n(e[6])+","+n(e[7])+","+n(e[8])+","+n(-e[9])+","+n(e[10])+","+n(e[11])+","+n(e[12])+","+n(-e[13])+","+n(e[14])+","+n(e[15])+")"}function w(t){const e=t.elements,s="matrix3d("+n(e[0])+","+n(e[1])+","+n(e[2])+","+n(e[3])+","+n(-e[4])+","+n(-e[5])+","+n(-e[6])+","+n(-e[7])+","+n(e[8])+","+n(e[9])+","+n(e[10])+","+n(e[11])+","+n(e[12])+","+n(e[13])+","+n(e[14])+","+n(e[15])+")";return"translate(-50%,-50%)"+s}function r(t,e,s,d){if(t.isCSS3DObject){const o=t.visible===!0&&t.layers.test(s.layers)===!0;if(t.element.style.display=o===!0?"":"none",o===!0){t.onBeforeRender(i,e,s);let m;t.isCSS3DSprite?(h.copy(s.matrixWorldInverse),h.transpose(),t.rotation2D!==0&&h.multiply(F.makeRotationZ(t.rotation2D)),t.matrixWorld.decompose(N,I,R),h.setPosition(N),h.scale(R),h.elements[3]=0,h.elements[7]=0,h.elements[11]=0,h.elements[15]=1,m=w(h)):m=w(t.matrixWorld);const y=t.element,_=c.objects.get(t);if(_===void 0||_.style!==m){y.style.transform=m;const A={style:m};c.objects.set(t,A)}y.parentNode!==u&&u.appendChild(y),t.onAfterRender(i,e,s)}}for(let o=0,m=t.children.length;o<m;o++)r(t.children[o],e,s)}}}export{B as C,k as a,Q as b,T as c,L as d};
