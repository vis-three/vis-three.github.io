var v=Object.defineProperty;var w=(e,n,t)=>n in e?v(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var r=(e,n,t)=>(w(e,typeof n!="symbol"?n+"":n,t),t);import{b as E,t as p,a as i}from"./index.202ebdec.js";import{a as m,b as f}from"./index.e6be8a02.js";import{n as h}from"./three.237d835c.js";const b="@vis-three/strategy-keyboard-move-render";class u extends E{constructor(t,a){super();r(this,"object");r(this,"domElement");r(this,"enabled",!0);r(this,"movementSpeed",1);r(this,"quickenSpeed",10);r(this,"space","local");r(this,"forwrad",new h(0,0,-1));r(this,"extendKeyDown",()=>{});r(this,"extendKeyUp",()=>{});r(this,"moveForward",!1);r(this,"moveBackward",!1);r(this,"moveLeft",!1);r(this,"moveRight",!1);r(this,"quicken",!1);r(this,"worldVector",new h);r(this,"_onKeyDown",this.onKeyDown.bind(this));r(this,"_onKeyUp",this.onKeyUp.bind(this));a===void 0&&(console.warn('THREE.KeyboardMoveControls: The second parameter "domElement" is now mandatory.'),a=document.body),this.object=t,this.domElement=a,window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp)}setCamera(t){this.object=t}setDom(t){this.domElement=t}onKeyDown(t){switch(t.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break}t.shiftKey&&(this.quicken=!0),this.extendKeyDown(t)}onKeyUp(t){switch(t.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break}t.shiftKey||(this.quicken=!1),this.extendKeyUp(t)}update(t){if(this.enabled===!1)return;this.dispatchEvent({type:"beforeUpdate",delta:t,object:this.object});const a=t*this.movementSpeed+(this.quicken?this.quickenSpeed*t:0),s=this.space,o=this.object,d=this.worldVector,c=typeof this.forwrad=="object"?this.forwrad:this.forwrad(o),l=o.up;this.moveForward&&(s==="local"?o.translateZ(-a):(d.copy(c),o.position.addScaledVector(d,a))),this.moveBackward&&(s==="local"?o.translateZ(a):(d.copy(c).applyAxisAngle(l,Math.PI),o.position.addScaledVector(d,a))),this.moveLeft&&(s==="local"?o.translateX(-a):(d.copy(c).applyAxisAngle(l,Math.PI/2),o.position.addScaledVector(d,a))),this.moveRight&&(s==="local"?o.translateX(a):(d.copy(c).applyAxisAngle(l,-Math.PI/2),o.position.addScaledVector(d,a))),this.dispatchEvent({type:"afterUpdate",delta:t,object:o})}dispose(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp)}}const K="@vis-three/plugin-keyboard-move-controls",y=p(K),A=function(e={}){let n,t,a;return{name:y,install(s){const o=new u(e.target||s.camera,s.dom);e.movementSpeed&&(o.movementSpeed=e.movementSpeed),e.quickenSpeed&&(o.quickenSpeed=e.quickenSpeed),e.space&&(o.space=e.space),e.forwrad&&(o.forwrad=e.forwrad),e.extendKeyDown&&(o.extendKeyDown=e.extendKeyDown),e.extendKeyUp&&(o.extendKeyUp=e.extendKeyUp),e.beforeUpdate&&o.addEventListener("beforeUpdate",e.beforeUpdate),e.afterUpdate&&o.addEventListener("afterUpdate",e.afterUpdate),s.keyboardMoveControls=o,n=d=>{o.setDom(d.dom)},s.addEventListener(i.SETDOM,n),t=d=>{o.setCamera(d.camera)},s.addEventListener(i.SETCAMERA,t),a=d=>{o.update(d.delta)},s.addEventListener(i.RENDER,a)},dispose(s){e.beforeUpdate&&s.keyboardMoveControls.removeEventListener("beforeUpdate",e.beforeUpdate),e.afterUpdate&&s.keyboardMoveControls.removeEventListener("afterUpdate",e.afterUpdate),s.removeEventListener(i.SETDOM,n),s.removeEventListener(i.SETCAMERA,t),s.removeEventListener(i.RENDER,a)}}},k=p(b),S=function(){let e;return{name:k,condition:[y,m],exec(n){e=t=>{n.keyboardMoveControls.update(t.delta)},n.renderManager.addEventListener(f.RENDER,e)},rollback(n){n.renderManager.removeEventListener(f.RENDER,e)}}};export{A as K,S as a};
