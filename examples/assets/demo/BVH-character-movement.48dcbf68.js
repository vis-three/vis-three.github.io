import"../modulepreload-polyfill.b7f2da20.js";import{l as B}from"../loadingTips.e8714600.js";import{w as u,aK as M,I as E,cc as x,M as b,bO as _,am as G,al as R,a3 as W,a as z}from"../three.3f33d046.js";import{m as A,Z as L}from"../vis-three.plugin-loader-manager.es.3fc670d5.js";import{W as k,C as H}from"../index.c0df7946.js";import{R as I}from"../index.0a430562.js";import{E as K}from"../index.0317c091.js";import{x as O}from"../vis-three.plugin-orbit-controls.es.1508a7f8.js";import{K as T,a as D}from"../index.c0bcd2a0.js";import{S as j}from"../index.9b9e13dd.js";import{M as U}from"../index.1849a9ca.js";import{E as q}from"../index.cee1ad1a.js";import{O as F}from"../index.e2e75f8b.js";import{S as Z}from"../index.2c9e736c.js";import{E as J}from"../curve.0ba3d968.js";/* empty css               */import"../Antdv.7b6104cc.js";import"../ShaderPass.025732a5.js";const v=new u,C=new u,g=new M;new E;const l=new x,S=5,N=20;let w=!1;const r=new b(new _(.5,.5,1),new G({color:"red"})),c=new u;r.geometry.translate(0,-.5,0);const y={radius:.5,segment:new x(new u,new u(0,-1,0))},a=J({plugins:[I({}),k({antialias:!0,alpha:!0}),K({WebGLMultisampleRenderTarget:!0}),H(),L({path:"/examples/"}),O(),j(),U({visualizer:!0,shapecast:{intersectsBounds:o=>o.intersectsBox(g),intersectsTriangle:o=>{const i=v,s=C,d=o.closestPointToSegment(l,i,s);if(d<y.radius){const t=y.radius-d,n=s.sub(i).normalize();l.start.addScaledVector(n,t),l.end.addScaledVector(n,t)}}}}),T({target:r,movementSpeed:10,quickenSpeed:10,space:"world",extendKeyDown:o=>{switch(o.code){case"Space":w&&(c.y=N);break}},beforeUpdate:({delta:o})=>{c.y+=w?0:o*-30,r.position.addScaledVector(c,o)}})],strategy:[q(),F(),D(),Z()]}).setDom(document.getElementById("app")).setSize().setStats(!0);B(a);const P=()=>{c.y=0,r.position.set(47,0,90),a.camera.position.set(0,5,15),a.orbitControls.target.set(0,0,0)},V=new R("white",7);V.position.set(-5,5,10);a.scene.add(r,V);P();const Q=new u;a.keyboardMoveControls.forwrad=o=>Q.set(0,0,-1).applyAxisAngle(o.up,a.orbitControls.getAzimuthalAngle());const X=o=>{r.updateMatrixWorld();const i=a.camera,s=a.orbitControls;g.makeEmpty(),l.copy(y.segment),l.start.applyMatrix4(r.matrixWorld),l.end.applyMatrix4(r.matrixWorld),g.expandByPoint(l.start),g.expandByPoint(l.end),g.min.addScalar(-y.radius),g.max.addScalar(y.radius),a.meshBVHManager.shapecast();const d=v;d.copy(l.start);const t=C;t.subVectors(d,r.position),w=t.y>Math.abs(o*c.y*.25);const n=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(n),r.position.add(t),w?c.set(0,0,0):(t.normalize(),c.addScaledVector(t,-t.dot(c))),r.position.y<-80&&P(),i.position.sub(s.target),s.target.copy(r.position),i.position.add(r.position)};a.keyboardMoveControls.addEventListener("afterUpdate",o=>{for(let i=0;i<S;i+=1)X(o.delta/S)});a.loadResourcesAsync(["/model/glb/dungeon_low_poly_game_level_challenge/scene.gltf"]).then(o=>{const s=o.resourceMap.get("/model/glb/dungeon_low_poly_game_level_challenge/scene.gltf").scene;s.scale.setScalar(.03);const d=new M;d.setFromObject(s),d.getCenter(s.position).negate(),s.updateMatrixWorld(!0);const t={};s.traverse(e=>{if(!(/Boss/.test(e.name)||/Enemie/.test(e.name)||/Shield/.test(e.name)||/Sword/.test(e.name)||/Character/.test(e.name)||/Gate/.test(e.name)||/Cube/.test(e.name)||e.material&&e.material.color.r===1)&&e.isMesh){const f=e.material.color.getHex();t[f]=t[f]||[],t[f].push(e)}});const n=new W;for(const e in t){const f=t[e],h=[];if(f.forEach(p=>{if(p.material.emissive.r!==0)n.attach(p);else{const m=p.geometry.clone();m.applyMatrix4(p.matrixWorld),h.push(m)}}),h.length){const p=A(h),m=new b(p,new z({color:parseInt(e),shadowSide:2}));m.castShadow=!0,m.receiveShadow=!0,m.material.shadowSide=2,n.add(m)}}n.updateMatrixWorld(!0),n.traverse(e=>{e.geometry&&a.addBVH(e)}),a.scene.add(n),a.play()});window.engine=a;
