import"../modulepreload-polyfill.b7f2da20.js";import{l as B}from"../loadingTips.c31b1441.js";import{aA as M,w as E,bK as b,M as x,bd as _,a9 as G,q as u,a8 as R,K as W,a as L}from"../three.837c9bb0.js";import{m as A,M as z}from"../index.b9fb1201.js";import{W as K,C as O}from"../index.be5e1784.js";import{R as k}from"../index.813bc471.js";import{E as H}from"../index.db239e15.js";import{L as I}from"../vis-three.plugin-loader-manager.es.dd5ac293.js";import{O as T}from"../index.d505a6dc.js";import{K as D,a as j}from"../index.7bee1dbf.js";import{S as q}from"../index.0eec027b.js";import{E as U}from"../index.c0066b9f.js";import{O as F}from"../index.80c3482e.js";import{S as J}from"../index.ca59a760.js";import{d as N}from"../index.5fd0e639.js";/* empty css               */import"../Antdv.a86c3c0d.js";import"../Pass.1ae4f2a0.js";const v=new u,P=new u,g=new M;new E;const l=new b,S=5,Q=20;let w=!1;const r=new x(new _(.5,.5,1),new G({color:"red"})),c=new u;r.geometry.translate(0,-.5,0);const y={radius:.5,segment:new b(new u,new u(0,-1,0))},a=N({plugins:[k({}),K({antialias:!0,alpha:!0}),H({WebGLMultisampleRenderTarget:!0}),O(),I({path:"/examples/"}),T(),q(),z({visualizer:!0,shapecast:{intersectsBounds:o=>o.intersectsBox(g),intersectsTriangle:o=>{const i=v,s=P,d=o.closestPointToSegment(l,i,s);if(d<y.radius){const t=y.radius-d,n=s.sub(i).normalize();l.start.addScaledVector(n,t),l.end.addScaledVector(n,t)}}}}),D({target:r,movementSpeed:10,quickenSpeed:10,space:"world",extendKeyDown:o=>{switch(o.code){case"Space":w&&(c.y=Q);break}},beforeUpdate:({delta:o})=>{c.y+=w?0:o*-30,r.position.addScaledVector(c,o)}})],strategy:[U(),F(),j(),J()]}).setDom(document.getElementById("app")).setSize().setStats(!0);B(a);const C=()=>{c.y=0,r.position.set(47,0,90),a.camera.position.set(0,5,15),a.orbitControls.target.set(0,0,0)},V=new R("white",7);V.position.set(-5,5,10);a.scene.add(r,V);C();const X=new u;a.keyboardMoveControls.forwrad=o=>X.set(0,0,-1).applyAxisAngle(o.up,a.orbitControls.getAzimuthalAngle());const Y=o=>{r.updateMatrixWorld();const i=a.camera,s=a.orbitControls;g.makeEmpty(),l.copy(y.segment),l.start.applyMatrix4(r.matrixWorld),l.end.applyMatrix4(r.matrixWorld),g.expandByPoint(l.start),g.expandByPoint(l.end),g.min.addScalar(-y.radius),g.max.addScalar(y.radius),a.meshBVHManager.shapecast();const d=v;d.copy(l.start);const t=P;t.subVectors(d,r.position),w=t.y>Math.abs(o*c.y*.25);const n=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(n),r.position.add(t),w?c.set(0,0,0):(t.normalize(),c.addScaledVector(t,-t.dot(c))),r.position.y<-80&&C(),i.position.sub(s.target),s.target.copy(r.position),i.position.add(r.position)};a.keyboardMoveControls.addEventListener("afterUpdate",o=>{for(let i=0;i<S;i+=1)Y(o.delta/S)});a.loadResourcesAsync(["/model/glb/dungeon_low_poly_game_level_challenge/scene.gltf"]).then(o=>{const s=o.resourceMap.get("/model/glb/dungeon_low_poly_game_level_challenge/scene.gltf").scene;s.scale.setScalar(.03);const d=new M;d.setFromObject(s),d.getCenter(s.position).negate(),s.updateMatrixWorld(!0);const t={};s.traverse(e=>{if(!(/Boss/.test(e.name)||/Enemie/.test(e.name)||/Shield/.test(e.name)||/Sword/.test(e.name)||/Character/.test(e.name)||/Gate/.test(e.name)||/Cube/.test(e.name)||e.material&&e.material.color.r===1)&&e.isMesh){const f=e.material.color.getHex();t[f]=t[f]||[],t[f].push(e)}});const n=new W;for(const e in t){const f=t[e],h=[];if(f.forEach(p=>{if(p.material.emissive.r!==0)n.attach(p);else{const m=p.geometry.clone();m.applyMatrix4(p.matrixWorld),h.push(m)}}),h.length){const p=A(h),m=new x(p,new L({color:parseInt(e),shadowSide:2}));m.castShadow=!0,m.receiveShadow=!0,m.material.shadowSide=2,n.add(m)}}n.updateMatrixWorld(!0),n.traverse(e=>{e.geometry&&a.addBVH(e)}),a.scene.add(n),a.play()});window.engine=a;
