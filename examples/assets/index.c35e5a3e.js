var m=Object.defineProperty;var v=(c,i,s)=>i in c?m(c,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[i]=s;var a=(c,i,s)=>(v(c,typeof i!="symbol"?i+"":i,s),s);import{a as b}from"./vis-three.plugin-pointer-manager.es.640cfa1a.js";import{b as f,t as j,a as u}from"./index.202ebdec.js";import{r as y}from"./three.237d835c.js";var E;(function(c){c.POINTERDOWN="pointerdown",c.POINTERUP="pointerup",c.POINTERMOVE="pointermove",c.POINTERENTER="pointerenter",c.POINTERLEAVE="pointerleave",c.CLICK="click",c.DBLCLICK="dblclick",c.CONTEXTMENU="contextmenu"})(E||(E={}));class O extends f{constructor(s){super();a(this,"raycaster");a(this,"scene");a(this,"camera");a(this,"filter",new Set);a(this,"recursive",!1);a(this,"penetrate",!1);a(this,"propagation",!1);a(this,"delegation",!1);this.raycaster=new y,this.camera=s.camera,this.scene=s.scene,s.recursive&&(this.recursive=s.recursive),s.penetrate&&(this.penetrate=s.penetrate),s.raycaster&&Object.assign(this.raycaster.params,s.raycaster.params)}setScene(s){return this.scene=s,this}setCamera(s){return this.camera=s,this}addFilterObject(s){return this.filter.add(s),this}removeFilterObject(s){return this.filter.delete(s),this}intersectObject(s){this.raycaster.setFromCamera(s,this.camera);const t=this.filter,l=this.scene.children.filter(p=>!t.has(p));return this.raycaster.intersectObjects(l,this.recursive)}use(s){const t=function(n,r){return Object.assign({},n,r)},l=(n,r)=>{const e=this.intersectObject(n.mouse);if(e.length)if(this.penetrate)for(const d of e)d.object.dispatchEvent(t(n,{type:r,intersection:d}));else{const d=e[0];d.object.dispatchEvent(t(n,{type:r,intersection:d}))}this.dispatchEvent(t(n,{type:r,intersections:e}))},p=["pointerdown","pointerup","mousedown","mouseup","pointermove","click","dblclick","contextmenu"];for(const n of p)s.addEventListener(n,r=>{l(r,n)});const h=new Map;let o=null;return s.addEventListener("pointermove",n=>{const r=this.intersectObject(n.mouse);if(this.penetrate){if(!r.length){h.forEach(e=>{e.object.dispatchEvent(t(n,{type:"pointerleave",intersection:e})),e.object.dispatchEvent(t(n,{type:"mouseleave",intersection:e}))}),h.clear();return}for(const e of r)h.has(e.object)?(e.object.dispatchEvent(t(n,{type:"pointermove",intersection:e})),e.object.dispatchEvent(t(n,{type:"mousemove",intersection:e})),h.delete(e.object)):(e.object.dispatchEvent(t(n,{type:"pointerenter",intersection:e})),e.object.dispatchEvent(t(n,{type:"mouseenter",intersection:e})));for(const e of h.values())e.object.dispatchEvent(t(n,{type:"pointerleave",intersection:e})),e.object.dispatchEvent(t(n,{type:"mouseleave",intersection:e}));h.clear();for(const e of r)h.set(e.object,e)}else{if(!r.length){o&&(o.object.dispatchEvent(t(n,{type:"pointerleave",intersection:o})),o.object.dispatchEvent(t(n,{type:"mouseleave",intersection:o})),o=null);return}const e=r[0];if(!o){e.object.dispatchEvent(t(n,{type:"pointerenter",intersection:e})),e.object.dispatchEvent(t(n,{type:"mouseenter",intersection:e})),o=e;return}if(e.object!==o.object){o.object.dispatchEvent(t(n,{type:"pointerleave",intersection:e})),o.object.dispatchEvent(t(n,{type:"mouseleave",intersection:e})),e.object.dispatchEvent(t(n,{type:"pointerenter",intersection:e})),e.object.dispatchEvent(t(n,{type:"mouseenter",intersection:e})),o=e;return}e.object===o.object&&(e.object.dispatchEvent(t(n,{type:"pointermove",intersection:e})),e.object.dispatchEvent(t(n,{type:"mousemove",intersection:e})))}this.dispatchEvent(t(n,{type:"pointermove",intersections:r})),this.dispatchEvent(t(n,{type:"mousemove",intersections:r}))}),this}}const C="@vis-three/plugin-event-manager",g=j(C),S=function(c){let i,s;return{name:g,deps:b,install(t){const l=new O(Object.assign({scene:t.scene,camera:t.camera},c));l.use(t.pointerManager),t.eventManager=l,i=p=>{t.eventManager.setCamera(p.camera)},s=p=>{t.eventManager.setScene(p.scene)},t.addEventListener(u.SETCAMERA,i),t.addEventListener(u.SETSCENE,s)},dispose(t){t.removeEventListener(u.SETCAMERA,i),t.removeEventListener(u.SETSCENE,s),i=void 0,s=void 0}}};export{S as E,E as a,g as b};
