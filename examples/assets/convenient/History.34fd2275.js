var L=Object.defineProperty;var O=(t,e,o)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var y=(t,e,o)=>(O(t,typeof e!="symbol"?e+"":e,o),o);import"../modulepreload-polyfill.b7f2da20.js";import{M as S,B as D,a as b,bo as k,P as G}from"../three.237d835c.js";import{H,A as C}from"../vis-three.convenient.es.7b860830.js";import{M as K}from"../index.d0645150.js";import"../index.202ebdec.js";import"../index.e6be8a02.js";import"../index.1d3a6ec0.js";import"../vis-three.plugin-pointer-manager.es.640cfa1a.js";import"../index.c35e5a3e.js";import"../index.2e2f06f6.js";import"../ShaderPass.02f07bc0.js";import"../vis-three.plugin-orbit-controls.es.9991f892.js";import"../index.4ec3bfd2.js";import"../index.ea2b9d59.js";import"../index.591a8368.js";import"../index.a30a6c1f.js";import"../index.12fd638d.js";import"../index.32dc3bb0.js";import"../vis-three.plugin-keyboard-manager.es.417ffa7e.js";import"../Antdv.414c4eb5.js";import"../vis-three.plugin-object-helper.es.15c18b4e.js";import"../index.edc751ad.js";import"../CSS3DRenderer.ba0f6fa5.js";import"../index.2f498209.js";import"../index.117a61e1.js";import"../index.3b8dbf96.js";import"../index.c0475655.js";import"../index.664a593f.js";import"../index.cd2c2c2e.js";import"../index.a089cc34.js";import"../index.bca5cc71.js";import"../index.5331312d.js";import"../vis-three.strategy-multi-renderer.es.a35ffd0a.js";const n=class extends C{constructor({objects:e,engine:o}){super(),this.oldObjects=[].concat(n.cacheSection),this.newObjects=[].concat(e),this.engine=o,n.cacheSection=[].concat(e)}next(){n.status=!0,this.engine.setSelectionBox([this.newObjects])}prev(){n.status=!0,this.engine.setSelectionBox([this.oldObjects])}};let s=n;y(s,"status",!1),y(s,"cacheSection",[]);class P extends C{constructor({transformControls:e}){super(),this.nextState={mode:"translate",space:"world",tranform:"",objectMap:new Map},this.prevState={mode:"translate",space:"world",tranform:"",objectMap:new Map},this.transfromControls=e}generate(e){const o=this.transfromControls,c=o.mode,m=c==="rotate"?"rotation":c==="translate"?"position":c,z=o.getTransObjectSet(),d=this[`${e}State`];d.mode=c,d.tranform=m,d.space=o.space;const B=d.objectMap;z.forEach(r=>{B.set(r,{x:r[m].x,y:r[m].y,z:r[m].z})}),this[e]=function(){const r=this.transfromControls,l=this[`${e}State`];r.mode=l.mode,r.space=l.space;const f=l.tranform,M=[];l.objectMap.forEach((g,i)=>{i[f].x=g.x,i[f].y=g.y,i[f].z=g.z,i.updateMatrixWorld(),M.push(i)}),r.setAttach(...M)}}}const a=new K().setDom(document.getElementById("app")).setSize().setStats(!0).play(),h=new H(50);a.keyboardManager.register({shortcutKey:["ctrl","z"],desp:"undo",keyup:t=>{t==null||t.preventDefault(),h.undo()}}).register({shortcutKey:["ctrl","y"],desp:"redo",keyup:t=>{t==null||t.preventDefault(),h.redo()}});const x=a.scene,u=new S(new D(10,10,10),new b({color:"rgb(255, 105, 100)"}));u.position.x=10;x.add(u);u.updateMatrixWorld();const E=new S(new k(5,32,32),new b({color:"rgb(255, 205, 100)"}));E.position.x=-10;x.add(E);const j=new G("rgb(255, 255, 255)",1,300,0);j.position.y=30;x.add(j);a.setSelectionBox([u]);a.addEventListener("selected",t=>{if(s.status){s.status=!1;return}!s.cacheSection.length&&!t.objects.length||h.apply(new s({objects:t.objects,engine:a}))});const w=a.transformControls;let p="";w.addEventListener("mouseDown",t=>{p=new P({transformControls:w}),p.generate("prev")});w.addEventListener("mouseUp",t=>{p.generate("next"),h.apply(p),p=""});
