var L=Object.defineProperty;var O=(t,e,o)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var w=(t,e,o)=>(O(t,typeof e!="symbol"?e+"":e,o),o);import"../modulepreload-polyfill.b7f2da20.js";import{M as S,B as D,a as b,bM as k,P as W}from"../three.3f33d046.js";import{W as C,A as G}from"../vis-three.convenient.es.3345d486.js";import{M as K}from"../index.46186441.js";import"../curve.0ba3d968.js";import"../index.0a430562.js";import"../index.c0df7946.js";import"../vis-three.plugin-pointer-manager.es.28277630.js";import"../index.b5597af3.js";import"../index.0317c091.js";import"../ShaderPass.025732a5.js";import"../vis-three.plugin-orbit-controls.es.1508a7f8.js";import"../index.ca8957d4.js";import"../index.bdebbb5d.js";import"../index.5b5c1015.js";import"../index.336b965b.js";import"../vis-three.plugin-transform-controls.es.5244fee5.js";import"../index.9b9e13dd.js";import"../vis-three.plugin-keyboard-manager.es.16e92de2.js";import"../Antdv.7b6104cc.js";import"../vis-three.plugin-object-helper.es.59a74f53.js";import"../vis-three.module-helper.es.c2fc8b4c.js";import"../vis-three.tdcm.es.ba892fff.js";import"../vis-three.plugin-loader-manager.es.3fc670d5.js";import"../G6.30609706.js";import"../index.fd7db63a.js";import"../CSS3DRenderer.56d2804d.js";import"../index.fe593856.js";import"../index.cee1ad1a.js";import"../index.e2e75f8b.js";import"../index.f411c2bc.js";import"../index.ad994be4.js";import"../index.2c9e736c.js";import"../index.bbdc45c2.js";import"../index.e7386c00.js";import"../index.f28a3380.js";import"../vis-three.strategy-multi-renderer.es.91c74cfe.js";const n=class extends C{constructor({objects:e,engine:o}){super(),this.oldObjects=[].concat(n.cacheSection),this.newObjects=[].concat(e),this.engine=o,n.cacheSection=[].concat(e)}next(){n.status=!0,this.engine.setSelectionBox([this.newObjects])}prev(){n.status=!0,this.engine.setSelectionBox([this.oldObjects])}};let s=n;w(s,"status",!1),w(s,"cacheSection",[]);class P extends C{constructor({transformControls:e}){super(),this.nextState={mode:"translate",space:"world",tranform:"",objectMap:new Map},this.prevState={mode:"translate",space:"world",tranform:"",objectMap:new Map},this.transfromControls=e}generate(e){const o=this.transfromControls,c=o.mode,m=c==="rotate"?"rotation":c==="translate"?"position":c,z=o.getTransObjectSet(),d=this[`${e}State`];d.mode=c,d.tranform=m,d.space=o.space;const B=d.objectMap;z.forEach(r=>{B.set(r,{x:r[m].x,y:r[m].y,z:r[m].z})}),this[e]=function(){const r=this.transfromControls,l=this[`${e}State`];r.mode=l.mode,r.space=l.space;const f=l.tranform,M=[];l.objectMap.forEach((g,i)=>{i[f].x=g.x,i[f].y=g.y,i[f].z=g.z,i.updateMatrixWorld(),M.push(i)}),r.setAttach(...M)}}}const a=new K().setDom(document.getElementById("app")).setSize().setStats(!0).play(),h=new G(50);a.keyboardManager.register({shortcutKey:["ctrl","z"],desp:"undo",keyup:t=>{t==null||t.preventDefault(),h.undo()}}).register({shortcutKey:["ctrl","y"],desp:"redo",keyup:t=>{t==null||t.preventDefault(),h.redo()}});const y=a.scene,u=new S(new D(10,10,10),new b({color:"rgb(255, 105, 100)"}));u.position.x=10;y.add(u);u.updateMatrixWorld();const E=new S(new k(5,32,32),new b({color:"rgb(255, 205, 100)"}));E.position.x=-10;y.add(E);const j=new W("rgb(255, 255, 255)",1,300,0);j.position.y=30;y.add(j);a.setSelectionBox([u]);a.addEventListener("selected",t=>{if(s.status){s.status=!1;return}!s.cacheSection.length&&!t.objects.length||h.apply(new s({objects:t.objects,engine:a}))});const x=a.transformControls;let p="";x.addEventListener("mouseDown",t=>{p=new P({transformControls:x}),p.generate("prev")});x.addEventListener("mouseUp",t=>{p.generate("next"),h.apply(p),p=""});
