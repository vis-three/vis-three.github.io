import{t as I,b as S}from"./index.7d48aff8.js";import{c as x}from"./Antdv.a86c3c0d.js";var O={exports:{}};(function(y,o){(function(u,g){y.exports=g()})(x,function(){function u(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(s){return typeof s}:u=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},u(t)}function g(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function E(t,s){for(var e=0;e<s.length;e++){var n=s[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function C(t,s,e){return s&&E(t.prototype,s),e&&E(t,e),t}function L(t){return D(t)||T(t)||P(t)||U()}function D(t){if(Array.isArray(t))return k(t)}function T(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}function P(t,s){if(!!t){if(typeof t=="string")return k(t,s);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return k(t,s)}}function k(t,s){(s==null||s>t.length)&&(s=t.length);for(var e=0,n=new Array(s);e<s;e++)n[e]=t[e];return n}function U(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var b=function(){function t(s){g(this,t),this.sourceStr=s,this.subCombos=t.parseComboStr(s),this.keyNames=this.subCombos.reduce(function(e,n){return e.concat(n)},[])}return C(t,[{key:"check",value:function(e){for(var n=0,i=0;i<this.subCombos.length;i+=1)if(n=this._checkSubCombo(this.subCombos[i],n,e),n===-1)return!1;return!0}},{key:"isEqual",value:function(e){if(!e||typeof e!="string"&&u(e)!=="object"||(typeof e=="string"&&(e=new t(e)),this.subCombos.length!==e.subCombos.length))return!1;for(var n=0;n<this.subCombos.length;n+=1)if(this.subCombos[n].length!==e.subCombos[n].length)return!1;for(var i=0;i<this.subCombos.length;i+=1){for(var r=this.subCombos[i],a=e.subCombos[i].slice(0),d=0;d<r.length;d+=1){var f=r[d],h=a.indexOf(f);h>-1&&a.splice(h,1)}if(a.length!==0)return!1}return!0}},{key:"_checkSubCombo",value:function(e,n,i){e=e.slice(0),i=i.slice(n);for(var r=n,a=0;a<e.length;a+=1){var d=e[a];if(d[0]==="\\"){var f=d.slice(1);(f===t.comboDeliminator||f===t.keyDeliminator)&&(d=f)}var h=i.indexOf(d);if(h>-1&&(e.splice(a,1),a-=1,h>r&&(r=h),e.length===0))return r}return-1}}]),t}();b.comboDeliminator=">",b.keyDeliminator="+",b.parseComboStr=function(t){for(var s=b._splitStr(t,b.comboDeliminator),e=[],n=0;n<s.length;n+=1)e.push(b._splitStr(s[n],b.keyDeliminator));return e},b._splitStr=function(t,s){for(var e=t,n=s,i="",r=[],a=0;a<e.length;a+=1)a>0&&e[a]===n&&e[a-1]!=="\\"&&(r.push(i.trim()),i="",a+=1),i+=e[a];return i&&r.push(i.trim()),r};var B=function(){function t(s){g(this,t),this.localeName=s,this.activeTargetKeys=[],this.pressedKeys=[],this._appliedMacros=[],this._keyMap={},this._killKeyCodes=[],this._macros=[]}return C(t,[{key:"bindKeyCode",value:function(e,n){typeof n=="string"&&(n=[n]),this._keyMap[e]=n}},{key:"bindMacro",value:function(e,n){typeof n=="string"&&(n=[n]);var i=null;typeof n=="function"&&(i=n,n=null);var r={keyCombo:new b(e),keyNames:n,handler:i};this._macros.push(r)}},{key:"getKeyCodes",value:function(e){var n=[];for(var i in this._keyMap){var r=this._keyMap[i].indexOf(e);r>-1&&n.push(i|0)}return n}},{key:"getKeyNames",value:function(e){return this._keyMap[e]||[]}},{key:"setKillKey",value:function(e){if(typeof e=="string"){for(var n=this.getKeyCodes(e),i=0;i<n.length;i+=1)this.setKillKey(n[i]);return}this._killKeyCodes.push(e)}},{key:"pressKey",value:function(e){if(typeof e=="string"){for(var n=this.getKeyCodes(e),i=0;i<n.length;i+=1)this.pressKey(n[i]);return}this.activeTargetKeys.length=0;for(var r=this.getKeyNames(e),a=0;a<r.length;a+=1)this.activeTargetKeys.push(r[a]),this.pressedKeys.indexOf(r[a])===-1&&this.pressedKeys.push(r[a]);this._applyMacros()}},{key:"releaseKey",value:function(e){if(typeof e=="string")for(var n=this.getKeyCodes(e),i=0;i<n.length;i+=1)this.releaseKey(n[i]);else{var r=this.getKeyNames(e),a=this._killKeyCodes.indexOf(e);if(a!==-1)this.pressedKeys.length=0;else for(var d=0;d<r.length;d+=1){var f=this.pressedKeys.indexOf(r[d]);f>-1&&this.pressedKeys.splice(f,1)}this.activeTargetKeys.length=0,this._clearMacros()}}},{key:"_applyMacros",value:function(){for(var e=this._macros.slice(0),n=0;n<e.length;n+=1){var i=e[n];if(i.keyCombo.check(this.pressedKeys)){i.handler&&(i.keyNames=i.handler(this.pressedKeys));for(var r=0;r<i.keyNames.length;r+=1)this.pressedKeys.indexOf(i.keyNames[r])===-1&&this.pressedKeys.push(i.keyNames[r]);this._appliedMacros.push(i)}}}},{key:"_clearMacros",value:function(){for(var e=0;e<this._appliedMacros.length;e+=1){var n=this._appliedMacros[e];if(!n.keyCombo.check(this.pressedKeys)){for(var i=0;i<n.keyNames.length;i+=1){var r=this.pressedKeys.indexOf(n.keyNames[i]);r>-1&&this.pressedKeys.splice(r,1)}n.handler&&(n.keyNames=null),this._appliedMacros.splice(e,1),e-=1}}}}]),t}(),A=function(){function t(s,e,n,i){g(this,t),this._locale=null,this._currentContext="",this._contexts={},this._listeners=[],this._appliedListeners=[],this._locales={},this._targetElement=null,this._targetWindow=null,this._targetPlatform="",this._targetUserAgent="",this._isModernBrowser=!1,this._targetKeyDownBinding=null,this._targetKeyUpBinding=null,this._targetResetBinding=null,this._paused=!1,this._contexts.global={listeners:this._listeners,targetWindow:s,targetElement:e,targetPlatform:n,targetUserAgent:i},this.setContext("global")}return C(t,[{key:"setLocale",value:function(e,n){var i=null;return typeof e=="string"?n?(i=new B(e),n(i,this._targetPlatform,this._targetUserAgent)):i=this._locales[e]||null:(i=e,e=i._localeName),this._locale=i,this._locales[e]=i,i&&(this._locale.pressedKeys=i.pressedKeys),this}},{key:"getLocale",value:function(e){return e||(e=this._locale.localeName),this._locales[e]||null}},{key:"bind",value:function(e,n,i,r){if((e===null||typeof e=="function")&&(r=i,i=n,n=e,e=null),e&&u(e)==="object"&&typeof e.length=="number"){for(var a=0;a<e.length;a+=1)this.bind(e[a],n,i);return this}return this._listeners.push({keyCombo:e?new b(e):null,pressHandler:n||null,releaseHandler:i||null,preventRepeat:!1,preventRepeatByDefault:r||!1,executingHandler:!1}),this}},{key:"addListener",value:function(e,n,i,r){return this.bind(e,n,i,r)}},{key:"on",value:function(e,n,i,r){return this.bind(e,n,i,r)}},{key:"bindPress",value:function(e,n,i){return this.bind(e,n,null,i)}},{key:"bindRelease",value:function(e,n){return this.bind(e,null,n,preventRepeatByDefault)}},{key:"unbind",value:function(e,n,i){if((e===null||typeof e=="function")&&(i=n,n=e,e=null),e&&u(e)==="object"&&typeof e.length=="number"){for(var r=0;r<e.length;r+=1)this.unbind(e[r],n,i);return this}for(var a=0;a<this._listeners.length;a+=1){var d=this._listeners[a],f=!e&&!d.keyCombo||d.keyCombo&&d.keyCombo.isEqual(e),h=!n&&!i||!n&&!d.pressHandler||n===d.pressHandler,c=!n&&!i||!i&&!d.releaseHandler||i===d.releaseHandler;f&&h&&c&&(this._listeners.splice(a,1),a-=1)}return this}},{key:"removeListener",value:function(e,n,i){return this.unbind(e,n,i)}},{key:"off",value:function(e,n,i){return this.unbind(e,n,i)}},{key:"setContext",value:function(e){if(this._locale&&this.releaseAllKeys(),!this._contexts[e]){var n=this._contexts.global;this._contexts[e]={listeners:[],targetWindow:n.targetWindow,targetElement:n.targetElement,targetPlatform:n.targetPlatform,targetUserAgent:n.targetUserAgent}}var i=this._contexts[e];return this._currentContext=e,this._listeners=i.listeners,this.stop(),this.watch(i.targetWindow,i.targetElement,i.targetPlatform,i.targetUserAgent),this}},{key:"getContext",value:function(){return this._currentContext}},{key:"withContext",value:function(e,n){var i=this.getContext();return this.setContext(e),n(),this.setContext(i),this}},{key:"watch",value:function(e,n,i,r){var a=this;this.stop();var d=typeof globalThis!="undefined"?globalThis:typeof x!="undefined"?x:typeof window!="undefined"?window:{};if(!e){if(!d.addEventListener&&!d.attachEvent){if(this._currentContext==="global")return;throw new Error("Cannot find window functions addEventListener or attachEvent.")}e=d}if(typeof e.nodeType=="number"&&(r=i,i=n,n=e,e=d),!e.addEventListener&&!e.attachEvent)throw new Error("Cannot find addEventListener or attachEvent methods on targetWindow.");this._isModernBrowser=!!e.addEventListener;var f=e.navigator&&e.navigator.userAgent||"",h=e.navigator&&e.navigator.platform||"";n&&n!==null||(n=e.document),i&&i!==null||(i=h),r&&r!==null||(r=f),this._targetKeyDownBinding=function(p){a.pressKey(p.keyCode,p),a._handleCommandBug(p,h)},this._targetKeyUpBinding=function(p){a.releaseKey(p.keyCode,p)},this._targetResetBinding=function(p){a.releaseAllKeys(p)},this._bindEvent(n,"keydown",this._targetKeyDownBinding),this._bindEvent(n,"keyup",this._targetKeyUpBinding),this._bindEvent(e,"focus",this._targetResetBinding),this._bindEvent(e,"blur",this._targetResetBinding),this._targetElement=n,this._targetWindow=e,this._targetPlatform=i,this._targetUserAgent=r;var c=this._contexts[this._currentContext];return c.targetWindow=this._targetWindow,c.targetElement=this._targetElement,c.targetPlatform=this._targetPlatform,c.targetUserAgent=this._targetUserAgent,this}},{key:"stop",value:function(){if(!(!this._targetElement||!this._targetWindow))return this._unbindEvent(this._targetElement,"keydown",this._targetKeyDownBinding),this._unbindEvent(this._targetElement,"keyup",this._targetKeyUpBinding),this._unbindEvent(this._targetWindow,"focus",this._targetResetBinding),this._unbindEvent(this._targetWindow,"blur",this._targetResetBinding),this._targetWindow=null,this._targetElement=null,this}},{key:"pressKey",value:function(e,n){if(this._paused)return this;if(!this._locale)throw new Error("Locale not set");return this._locale.pressKey(e),this._applyBindings(n),this}},{key:"releaseKey",value:function(e,n){if(this._paused)return this;if(!this._locale)throw new Error("Locale not set");return this._locale.releaseKey(e),this._clearBindings(n),this}},{key:"releaseAllKeys",value:function(e){if(this._paused)return this;if(!this._locale)throw new Error("Locale not set");return this._locale.pressedKeys.length=0,this._clearBindings(e),this}},{key:"pause",value:function(){return this._paused?this:(this._locale&&this.releaseAllKeys(),this._paused=!0,this)}},{key:"resume",value:function(){return this._paused=!1,this}},{key:"reset",value:function(){return this.releaseAllKeys(),this._listeners.length=0,this}},{key:"_bindEvent",value:function(e,n,i){return this._isModernBrowser?e.addEventListener(n,i,!1):e.attachEvent("on"+n,i)}},{key:"_unbindEvent",value:function(e,n,i){return this._isModernBrowser?e.removeEventListener(n,i,!1):e.detachEvent("on"+n,i)}},{key:"_getGroupedListeners",value:function(){var e=[],n=[],i=this._listeners;return this._currentContext!=="global"&&(i=[].concat(L(i),L(this._contexts.global.listeners))),i.sort(function(r,a){return(a.keyCombo?a.keyCombo.keyNames.length:0)-(r.keyCombo?r.keyCombo.keyNames.length:0)}).forEach(function(r){for(var a=-1,d=0;d<n.length;d+=1)(n[d]===null&&r.keyCombo===null||n[d]!==null&&n[d].isEqual(r.keyCombo))&&(a=d);a===-1&&(a=n.length,n.push(r.keyCombo)),e[a]||(e[a]=[]),e[a].push(r)}),e}},{key:"_applyBindings",value:function(e){var n=this,i=!1;e||(e={}),e.preventRepeat=function(){i=!0},e.pressedKeys=this._locale.pressedKeys.slice(0);for(var r=this._locale.activeTargetKeys,a=this._locale.pressedKeys.slice(0),d=this._getGroupedListeners(),f=function(p){var w=d[p],v=w[0].keyCombo;if(v===null||v.check(a)&&r.some(function(G){return v.keyNames.includes(G)})){for(var M=0;M<w.length;M+=1){var l=w[M];!l.executingHandler&&l.pressHandler&&!l.preventRepeat&&(l.executingHandler=!0,l.pressHandler.call(n,e),l.executingHandler=!1,(i||l.preventRepeatByDefault)&&(l.preventRepeat=!0,i=!1)),n._appliedListeners.indexOf(l)===-1&&n._appliedListeners.push(l)}if(v)for(var _=0;_<v.keyNames.length;_+=1){var R=a.indexOf(v.keyNames[_]);R!==-1&&(a.splice(R,1),_-=1)}}},h=0;h<d.length;h+=1)f(h)}},{key:"_clearBindings",value:function(e){e||(e={}),e.pressedKeys=this._locale.pressedKeys.slice(0);for(var n=0;n<this._appliedListeners.length;n+=1){var i=this._appliedListeners[n],r=i.keyCombo;(r===null||!r.check(this._locale.pressedKeys))&&(i.preventRepeat=!1,(r!==null||e.pressedKeys.length===0)&&(this._appliedListeners.splice(n,1),n-=1),!i.executingHandler&&i.releaseHandler&&(i.executingHandler=!0,i.releaseHandler.call(this,e),i.executingHandler=!1))}}},{key:"_handleCommandBug",value:function(e,n){var i=["shift","ctrl","alt","capslock","tab","command"];n.match("Mac")&&this._locale.pressedKeys.includes("command")&&!i.includes(this._locale.getKeyNames(e.keyCode)[0])&&this._targetKeyUpBinding(e)}}]),t}();function q(t,s,e){t.bindKeyCode(3,["cancel"]),t.bindKeyCode(8,["backspace"]),t.bindKeyCode(9,["tab"]),t.bindKeyCode(12,["clear"]),t.bindKeyCode(13,["enter"]),t.bindKeyCode(16,["shift"]),t.bindKeyCode(17,["ctrl"]),t.bindKeyCode(18,["alt","menu"]),t.bindKeyCode(19,["pause","break"]),t.bindKeyCode(20,["capslock"]),t.bindKeyCode(27,["escape","esc"]),t.bindKeyCode(32,["space","spacebar"]),t.bindKeyCode(33,["pageup"]),t.bindKeyCode(34,["pagedown"]),t.bindKeyCode(35,["end"]),t.bindKeyCode(36,["home"]),t.bindKeyCode(37,["left"]),t.bindKeyCode(38,["up"]),t.bindKeyCode(39,["right"]),t.bindKeyCode(40,["down"]),t.bindKeyCode(41,["select"]),t.bindKeyCode(42,["printscreen"]),t.bindKeyCode(43,["execute"]),t.bindKeyCode(44,["snapshot"]),t.bindKeyCode(45,["insert","ins"]),t.bindKeyCode(46,["delete","del"]),t.bindKeyCode(47,["help"]),t.bindKeyCode(145,["scrolllock","scroll"]),t.bindKeyCode(188,["comma",","]),t.bindKeyCode(190,["period","."]),t.bindKeyCode(191,["slash","forwardslash","/"]),t.bindKeyCode(192,["graveaccent","`"]),t.bindKeyCode(219,["openbracket","["]),t.bindKeyCode(220,["backslash","\\"]),t.bindKeyCode(221,["closebracket","]"]),t.bindKeyCode(222,["apostrophe","'"]),t.bindKeyCode(48,["zero","0"]),t.bindKeyCode(49,["one","1"]),t.bindKeyCode(50,["two","2"]),t.bindKeyCode(51,["three","3"]),t.bindKeyCode(52,["four","4"]),t.bindKeyCode(53,["five","5"]),t.bindKeyCode(54,["six","6"]),t.bindKeyCode(55,["seven","7"]),t.bindKeyCode(56,["eight","8"]),t.bindKeyCode(57,["nine","9"]),t.bindKeyCode(96,["numzero","num0"]),t.bindKeyCode(97,["numone","num1"]),t.bindKeyCode(98,["numtwo","num2"]),t.bindKeyCode(99,["numthree","num3"]),t.bindKeyCode(100,["numfour","num4"]),t.bindKeyCode(101,["numfive","num5"]),t.bindKeyCode(102,["numsix","num6"]),t.bindKeyCode(103,["numseven","num7"]),t.bindKeyCode(104,["numeight","num8"]),t.bindKeyCode(105,["numnine","num9"]),t.bindKeyCode(106,["nummultiply","num*"]),t.bindKeyCode(107,["numadd","num+"]),t.bindKeyCode(108,["numenter"]),t.bindKeyCode(109,["numsubtract","num-"]),t.bindKeyCode(110,["numdecimal","num."]),t.bindKeyCode(111,["numdivide","num/"]),t.bindKeyCode(144,["numlock","num"]),t.bindKeyCode(112,["f1"]),t.bindKeyCode(113,["f2"]),t.bindKeyCode(114,["f3"]),t.bindKeyCode(115,["f4"]),t.bindKeyCode(116,["f5"]),t.bindKeyCode(117,["f6"]),t.bindKeyCode(118,["f7"]),t.bindKeyCode(119,["f8"]),t.bindKeyCode(120,["f9"]),t.bindKeyCode(121,["f10"]),t.bindKeyCode(122,["f11"]),t.bindKeyCode(123,["f12"]),t.bindKeyCode(124,["f13"]),t.bindKeyCode(125,["f14"]),t.bindKeyCode(126,["f15"]),t.bindKeyCode(127,["f16"]),t.bindKeyCode(128,["f17"]),t.bindKeyCode(129,["f18"]),t.bindKeyCode(130,["f19"]),t.bindKeyCode(131,["f20"]),t.bindKeyCode(132,["f21"]),t.bindKeyCode(133,["f22"]),t.bindKeyCode(134,["f23"]),t.bindKeyCode(135,["f24"]),t.bindMacro("shift + `",["tilde","~"]),t.bindMacro("shift + 1",["exclamation","exclamationpoint","!"]),t.bindMacro("shift + 2",["at","@"]),t.bindMacro("shift + 3",["number","#"]),t.bindMacro("shift + 4",["dollar","dollars","dollarsign","$"]),t.bindMacro("shift + 5",["percent","%"]),t.bindMacro("shift + 6",["caret","^"]),t.bindMacro("shift + 7",["ampersand","and","&"]),t.bindMacro("shift + 8",["asterisk","*"]),t.bindMacro("shift + 9",["openparen","("]),t.bindMacro("shift + 0",["closeparen",")"]),t.bindMacro("shift + -",["underscore","_"]),t.bindMacro("shift + =",["plus","+"]),t.bindMacro("shift + [",["opencurlybrace","opencurlybracket","{"]),t.bindMacro("shift + ]",["closecurlybrace","closecurlybracket","}"]),t.bindMacro("shift + \\",["verticalbar","|"]),t.bindMacro("shift + ;",["colon",":"]),t.bindMacro("shift + '",["quotationmark","'"]),t.bindMacro("shift + !,",["openanglebracket","<"]),t.bindMacro("shift + .",["closeanglebracket",">"]),t.bindMacro("shift + /",["questionmark","?"]),s.match("Mac")?t.bindMacro("command",["mod","modifier"]):t.bindMacro("ctrl",["mod","modifier"]);for(var n=65;n<=90;n+=1){var i=String.fromCharCode(n+32),r=String.fromCharCode(n);t.bindKeyCode(n,i),t.bindMacro("shift + "+i,r),t.bindMacro("capslock + "+i,r)}var a=e.match("Firefox")?59:186,d=e.match("Firefox")?173:189,f=e.match("Firefox")?61:187,h,c;s.match("Mac")&&(e.match("Safari")||e.match("Chrome"))?(h=91,c=93):s.match("Mac")&&e.match("Opera")?(h=17,c=17):s.match("Mac")&&e.match("Firefox")&&(h=224,c=224),t.bindKeyCode(a,["semicolon",";"]),t.bindKeyCode(d,["dash","-"]),t.bindKeyCode(f,["equal","equalsign","="]),t.bindKeyCode(h,["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"]),t.bindKeyCode(c,["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"]),t.setKillKey("command")}var K=new A;return K.setLocale("us",q),K.Keyboard=A,K.Locale=B,K.KeyCombo=b,K})})(O);var m=O.exports,F=Object.defineProperty,$=(y,o,u)=>o in y?F(y,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):y[o]=u,z=(y,o,u)=>($(y,typeof o!="symbol"?o+"":o,u),u);const H="@vis-three/plugin-keyboard-manager";class Y extends S{constructor(){super(),z(this,"map",new Map)}generateSymbol(o){return Array.isArray(o)?o.join(" + "):o.shortcutKey.join(" + ")}watch(o){return o?m.watch(void 0,o):m.watch(),this}register(o){const u=this.generateSymbol(o);return this.map.has(u)?(console.warn(`KeyboardManager: shortcutKey already exist: ${u}. desp: ${this.map.get(u).desp}`),this):(m.bind(u,o.keydown||null,o.keyup),this.map.set(u,o),this)}update(o){const u=this.generateSymbol(o);return this.map.has(u)?(this.cancel(o.shortcutKey),this.register(o),this):(console.warn("KeyboardManager: shortcutKey unregister then exec register function"),this.register(o),this)}cancel(o){const u=this.generateSymbol(o);if(this.map.has(u)){const g=this.map.get(u);m.unbind(u,g.keydown||null,g.keyup),this.map.delete(u)}return this}checkRepeat(o){const u=this.generateSymbol(o);return this.map.has(u)}getDocs(){const o=[];return this.map.forEach(u=>{o.push({shortcutKey:[].concat(u.shortcutKey),desp:u.desp})}),o}}const J=I(H),X=function(y){return{name:J,install(o){o.keyboardManager=new Y,y&&y.keyboards&&y.keyboards.forEach(u=>{o.keyboardManager.register(u)})},dispose(o){o.keyboardManager.clear(),delete o.keyboardManager}}};export{X as K,J as a};
