import{t as m,b as j,m as g}from"./curve.0ba3d968.js";import{S as p,a5 as E}from"./three.3f33d046.js";import{o as H,a as v,s as y,r as L,N as f,f as M,b as O,M as S,z as F,j as w,m as C,y as D,d as G}from"./vis-three.module-helper.es.c2fc8b4c.js";class T extends g{constructor(e={}){super(),this.helperGenerator={PointLight:H,SpotLight:v,DirectionalLight:y,RectAreaLight:L,PerspectiveCamera:f,OrthographicCamera:f,Mesh:M,Group:O,Sprite:S,Points:F,Line:w,CSS3DPlane:C,CSS3DSprite:D,CSS2DPlane:G},this.helperFilter={AmbientLight:!0,HemisphereLight:!0,Object3D:!0,TransformControls:!0,Scene:!0},this.objectFilter=new Set,this.objectHelperMap=new Map,e.helperGenerator&&(this.helperGenerator=Object.assign(this.helperGenerator,e.helperGenerator)),e.helperFilter&&(this.helperFilter=Object.assign(this.helperFilter,e.helperFilter)),e.objectFilter&&(this.objectFilter=new Set(e.objectFilter.concat(Array.from(this.objectFilter))))}addFilteredObject(...e){for(const t of e)this.objectFilter.add(t);return this}addObjectHelper(e){if(this.objectFilter.has(e)||this.objectHelperMap.has(e)||this.helperFilter[e.type]||e.type.toLocaleLowerCase().includes("helper"))return null;if(!this.helperGenerator[e.type])return console.warn(`object helper can not support this type object: '${e.type}'`),null;const t=new this.helperGenerator[e.type](e);return this.objectHelperMap.set(e,t),t}disposeObjectHelper(e){if(this.objectFilter.has(e)||this.helperFilter[e.type]||e.type.toLocaleLowerCase().includes("helper"))return null;if(!this.objectHelperMap.has(e))return console.warn("object helper manager can not found this object`s helper: ",e),null;const t=this.objectHelperMap.get(e);return t.geometry&&t.geometry.dispose(),t.material&&(t.material instanceof E?t.material.dispose():t.material.forEach(c=>{c.dispose()})),this.objectHelperMap.delete(e),t}dispose(){for(const e of this.objectHelperMap.keys())this.disposeObjectHelper(e);this.objectHelperMap.clear()}}const N="@vis-three/plugin-object-helper",d="afterAdd",b="afterRemove";p.prototype.add=function(...s){if(!arguments.length)return this;if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}const e=s[0];if(e===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",s),this;if(e&&e.isObject3D){if(e.parent!==null){const t=this.children.indexOf(e);t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent({type:"removed"}))}e.parent=this,this.children.push(e),e.dispatchEvent({type:"added"})}else console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",s);return this};const P=p.prototype.add,A=p.prototype.remove;p.prototype.add=function(...s){return P.call(this,...s),this.dispatchEvent({type:d,objects:s}),this};p.prototype.remove=function(...s){return A.call(this,...s),this.dispatchEvent({type:b,objects:s}),this};const R=m(N),z=function(){let s,e,t;const c=new WeakSet;return{name:R,install(o){const a=new T,h=a.objectHelperMap;o.objectHelperManager=a,o.setObjectHelper=function(n){if(n)this.scene.traverse(r=>{h.has(r)&&this.scene.add(h.get(r))});else for(let r=0;r<this.scene.children.length;r++){const i=this.scene.children[r];h.has(i)&&this.scene.remove(h.get(i))}return this};const u=n=>{c.has(n)||(n.traverse(r=>{const i=a.addObjectHelper(r);i&&n.add(i)}),c.add(n))};e=n=>{const r=n.objects;for(const i of r){const l=a.addObjectHelper(i);l&&o.scene.add(l)}},t=n=>{const r=n.objects;for(const i of r){const l=a.disposeObjectHelper(i);l&&o.scene.remove(l)}},o.scene.addEventListener(d,e),o.scene.addEventListener(b,t),s=n=>{const r=n.scene;!c.has(r)&&u(r),r.hasEventListener(d,e)||r.addEventListener(d,e),r.hasEventListener(b,t)||r.addEventListener(b,t)},o.addEventListener(j.SETSCENE,s)},dispose(o){o.objectHelperManager.objectHelperMap.forEach(a=>{a.parent&&a.parent.remove(a)}),o.objectHelperManager.dispose(),delete o.objectHelperManager,delete o.setObjectHelper,o.removeEventListener(j.SETSCENE,s)}}};export{R as N,z as V,d,b as f};
