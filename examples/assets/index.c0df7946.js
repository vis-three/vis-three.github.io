import{t as x,b as o}from"./curve.0ba3d968.js";import{W as C,f as D,O as I}from"./three.3f33d046.js";const z="@vis-three/plugin-webgl-renderer",P=x(z),N=function(h){let n,i,d;return{name:P,install(e){e.webGLRenderer=new C(h);const r=e.webGLRenderer.domElement;r.style.position="absolute",r.style.top="0",r.style.left="0",r.classList.add("vis-webgl"),e.getScreenshot=async function(t={}){const a={width:this.dom.offsetWidth,height:this.dom.offsetHeight};!t.width&&(t.width=this.dom.offsetWidth),!t.height&&(t.height=this.dom.offsetHeight),!t.mine&&(t.mine="image/png");let l="";const R=this.webGLRenderer.getContext(),E=R.getParameter(R.MAX_RENDERBUFFER_SIZE)/4;if(t.width>E||t.height>E){const L=[],S=Math.ceil(t.width/E),v=Math.ceil(t.height/E),w=t.width/S,f=t.height/v,m=document.createElement("canvas");m.setAttribute("width",t.width.toString()),m.setAttribute("height",t.height.toString());const b=m.getContext("2d");if(!b)return console.warn("can not support canvas 2d;"),l;this.setSize(w,f);for(let s=0;s<S;s+=1)for(let c=0;c<v;c+=1)L.push({x:w*s,y:f*c});const g=[];L.forEach(s=>{this.camera.setViewOffset(t.width,t.height,s.x,s.y,w,f),this.webGLRenderer.render(this.scene,this.camera);const c=this.webGLRenderer.domElement.toDataURL(t.mine);g.push(new Promise((G,M)=>{const u=new Image;u.src=c,u.onload=()=>{b.drawImage(u,s.x,s.y,w,f),G(null)}}))}),this.setSize(a.width,a.height),await Promise.all(g).catch(s=>{console.warn(s)}),l=m.toDataURL(t.mine),this.camera.clearViewOffset()}else this.setSize(t.width,t.height),this.webGLRenderer.render(this.scene,this.camera),l=this.webGLRenderer.domElement.toDataURL(t.mine),this.setSize(a.width,a.height);return l},n=t=>{t.dom.appendChild(e.webGLRenderer.domElement)},e.addEventListener(o.SETDOM,n),i=t=>{e.webGLRenderer.setSize(t.width,t.height,!0)},e.addEventListener(o.SETSIZE,i),d=()=>{e.webGLRenderer.render(e.scene,e.camera)},e.addEventListener(o.RENDER,d)},dispose(e){e.removeEventListener(o.SETDOM,n),e.removeEventListener(o.SETSIZE,i),e.removeEventListener(o.RENDER,d),e.webGLRenderer.dispose(),delete e.webGLRenderer,delete e.getScreenshot}}},T=function(){let h,n;return{name:"CameraAdaptivePlugin",install(i){const d=(e,r,t)=>{e instanceof D?(e.aspect=r/t,e.updateProjectionMatrix()):e instanceof I&&(e.left=-r,e.right=r,e.top=t,e.bottom=-t,e.updateProjectionMatrix())};h=e=>{d(i.camera,e.width,e.height)},i.addEventListener(o.SETSIZE,h),n=e=>{d(i.camera,i.dom.offsetWidth,i.dom.offsetHeight)},i.addEventListener(o.SETCAMERA,n)},dispose(i){i.removeEventListener(o.SETSIZE,h),i.removeEventListener(o.SETCAMERA,n)}}};export{T as C,N as W,P as a};
